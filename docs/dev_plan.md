# CheerCast 開発計画書

## 🎯 プロジェクト概要
- **製品名**: CheerCast
- **目的**: 日々のメモから2人のパーソナリティがユーザーの頑張りを褒めるラジオ番組を自動生成するCLIツール
- **技術スタック**: TypeScript, Node.js, Google Gemini API, Google Cloud TTS, FFmpeg
- **開発期間**: 約4-6週間（MVP）

## 📊 開発フェーズ

### Phase 1: プロジェクト基盤構築（1週間）
#### タスク
1. **プロジェクト初期化**
   - TypeScriptプロジェクトのセットアップ
   - ESLint, Prettierの設定
   - Jestテスト環境の構築
   - GitHub Actionsの設定

2. **基本構造の実装**
   - CLIフレームワーク（Commander.js）の導入
   - プロジェクト構造の定義
   - 設定管理システムの実装（YAML）
   - エラーハンドリングの基盤

3. **外部サービス連携準備**
   - Google Cloud認証設定
   - API Keyの環境変数管理
   - 基本的な接続テスト

### Phase 2: コア機能実装（2週間）
#### タスク
1. **メモ解析機能**
   - テキストファイルパーサー実装
   - マルチフォーマット対応（.txt, .md, .json, .csv）
   - 日付・活動内容抽出ロジック
   - ポジティブ要素特定アルゴリズム

2. **AI台本生成機能**
   - Gemini APIクライアント実装
   - プロンプトエンジニアリング
   - 台本構造の定義（オープニング、メイン、エンディング）
   - パーソナリティ別の会話生成

3. **音声生成機能**
   - Google Cloud TTS統合
   - パーソナリティ別音声設定
   - 会話の自然な間の実装
   - 音声バッファ管理

### Phase 3: 音声処理と統合（1週間）
#### タスク
1. **音声合成機能**
   - FFmpeg統合
   - 複数音声トラックの結合
   - BGM追加機能
   - 音量正規化処理

2. **CLI統合**
   - メインコマンド実装（generate, preview, init）
   - オプション処理
   - プログレス表示
   - エラーメッセージの日本語化

### Phase 4: 品質向上とテスト（1週間）
#### タスク
1. **テスト実装**
   - ユニットテスト作成
   - 統合テスト実装
   - E2Eテストシナリオ

2. **パフォーマンス最適化**
   - 並列処理の実装
   - キャッシュ機構
   - メモリ使用量の最適化

3. **ドキュメント整備**
   - README.md作成
   - インストールガイド
   - 使用例とサンプル

## 🏗️ アーキテクチャ設計

### ディレクトリ構造
```
cheercast/
├── src/
│   ├── cli/              # CLIコマンド定義
│   ├── core/             # コアビジネスロジック
│   │   ├── parser/       # メモ解析
│   │   ├── generator/    # 台本生成
│   │   ├── voice/        # 音声生成
│   │   └── mixer/        # 音声合成
│   ├── services/         # 外部サービス連携
│   │   ├── gemini/       # Gemini API
│   │   ├── gcp-tts/      # Google Cloud TTS
│   │   └── ffmpeg/       # FFmpeg処理
│   ├── config/           # 設定管理
│   ├── utils/            # ユーティリティ
│   └── types/            # TypeScript型定義
├── tests/                # テストファイル
├── config/               # 設定ファイルテンプレート
└── docs/                 # ドキュメント
```

### 主要コンポーネント設計

#### 1. MemoParser
- 責務: メモファイルの読み込みと解析
- 入力: ファイルパスまたはディレクトリパス
- 出力: 構造化されたメモデータ

#### 2. ScriptGenerator
- 責務: AI(Gemini)を使用した台本生成
- 入力: 解析済みメモデータ、設定
- 出力: 構造化された台本データ

#### 3. VoiceGenerator
- 責務: 台本から音声ファイルの生成
- 入力: 台本データ、音声設定
- 出力: 音声バッファ配列

#### 4. AudioMixer
- 責務: 複数音声の結合とBGM追加
- 入力: 音声バッファ配列、BGM設定
- 出力: 最終的なMP3ファイル

## 🚀 実装優先度

### 高優先度
1. 基本的なCLI動作
2. テキストファイル解析
3. Gemini APIによる台本生成
4. Google Cloud TTSによる音声生成
5. 単純な音声結合

### 中優先度
1. 複数ファイル形式対応
2. BGM追加機能
3. 詳細な設定オプション
4. プログレス表示

### 低優先度
1. 高度な音声エフェクト
2. キャッシュ機能
3. バッチ処理

## 🛠️ 技術的な注意点

### API利用
- Gemini API: レート制限への対応（リトライロジック）
- Google Cloud TTS: 文字数制限への対応（分割処理）

### エラーハンドリング
- ネットワークエラー: 自動リトライ（最大3回）
- ファイルエラー: 明確なエラーメッセージ
- API制限: 適切な待機時間の実装

### パフォーマンス
- 大きなメモファイル: ストリーミング処理
- 音声生成: 並列処理での高速化
- メモリ管理: バッファサイズの制限

## 📈 成功指標
- [ ] 1分以内でのラジオ番組生成
- [ ] 自然な会話の実現
- [ ] 直感的なCLI操作
- [ ] 安定したエラーハンドリング
- [ ] 日本語ドキュメントの充実

## 🔄 イテレーション計画
1. **MVP完成後**: ユーザーフィードバック収集
2. **v1.1**: パフォーマンス改善とバグ修正
3. **v1.2**: 新機能追加（カスタムパーソナリティ、複数言語対応など）
4. **v2.0**: Web UI版の検討